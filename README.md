# salesman


CREATE TABLE CUSTOMER
(
        CUSTOMER_ID    INTEGER,
        CUST_NAME      VARCHAR(10),
        CITY           VARCHAR(10),
        GRADE          VARCHAR(10),
        SALESMAN_ID    INTEGER,
	PRIMARY KEY (CUSTOMER_ID)
);

DESC CUSTOMER

ALTER TABLE CUSTOMER
ADD FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN (SALESMAN_ID);


INSERT INTO CUSTOMER (   CUSTOMER_ID,    CUST_NAME,   CITY,    GRADE, SALESMAN_ID) 
VALUES(005 , 'MONIKA'  , 'BANGLORE' , 'A',012);

SELECT * FROM CUSTOMER


CREATE TABLE ORDERS
(
        ORD_NO         INTEGER,
        PURCHASE_AMT   INTEGER,
        ORD_DATE       DATE,
        CUSTOMER_ID    INTEGER,
        SALESMAN_ID    INTEGER,
	PRIMARY KEY (ORD_NO),
        FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER (CUSTOMER_ID), 
        FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN (SALESMAN_ID)
);

INSERT INTO ORDERS (ORD_NO,PURCHASE_AMT,ORD_DATE,CUSTOMER_ID,SALESMAN_ID) 
VALUES(06,6000, '25-MAR-22',006,009);

DESC ORDERS

SELECT * FROM ORDERS

CREATE TABLE SALESMAN
(
        SALESMAN_ID    INTEGER,
        NAME           VARCHAR(10),
        CITY           VARCHAR(10),
        COMMISSION     VARCHAR(10),
	PRIMARY KEY (SALESMAN_ID)
);

DESC SALESMAN;

INSERT INTO SALESMAN (  SALESMAN_ID,   NAME,  CITY,   COMMISSION) 
VALUES(021 , 'ANI'  , 'DELHI' , '15');

SELECT* FROM SALESMAN;



1.SELECT GRADE, COUNT (DISTINCT CUSTOMER_ID)
FROM CUSTOMER
GROUP BY GRADE
HAVING GRADE > (SELECT AVG(GRADE)
FROM CUSTOMER
WHERE CITY='BANGALORE');



2.SELECT SALESMAN_ID, NAME
FROM SALESMAN A
WHERE 1 < (SELECT COUNT (*)
FROM CUSTOMER
WHERE SALESMAN_ID=A.SALESMAN_ID);



3.SELECT SALESMAN.SALESMAN_ID, NAME, CUST_NAME, COMMISSION
FROM SALESMAN, CUSTOMER
WHERE SALESMAN.CITY = CUSTOMER.CITY
UNION
SELECT SALESMAN_ID, NAME, 'NO MATCH', COMMISSION
FROM SALESMAN
WHERE NOT CITY = ANY(SELECT CITY
FROM CUSTOMER)
ORDER BY 2 DESC;



4.CREATE VIEW ELITSALESMAN AS
SELECT B.ORD_DATE, A.SALESMAN_ID, A.NAME
FROM SALESMAN A, ORDERS B
WHERE A.SALESMAN_ID = B.SALESMAN_ID
AND B.PURCHASE_AMT=(SELECT MAX (PURCHASE_AMT)
FROM ORDERS C
WHERE C.ORD_DATE = B.ORD_DATE);

SELECT * FROM ELITSALESMAN



5.DELETE FROM SALESMAN
WHERE SALESMAN_ID=1234;

SELECT * FROM SALESMAN;
